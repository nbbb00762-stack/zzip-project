<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>iPhone — Гаджеттер дүкені</title>
  <link rel="stylesheet" href="iphone.css">
  <link rel="stylesheet" href="cart.css"> <!-- For cart counter -->
  <style>
    /* --- Custom Cursor Styles --- */
    body, a, button, input {
        cursor: none; /* Hide the default system cursor */
    }

    .custom-cursor, .cursor-follower {
        position: fixed;
        border-radius: 50%;
        pointer-events: none;
        z-index: 9999;
        transform: translate(-50%, -50%);
        transition: opacity 0.3s ease, transform 0.2s ease;
    }

    .custom-cursor {
        width: 8px;
        height: 8px;
        background-color: #fff;
        transition: transform 0.1s cubic-bezier(0.19, 1, 0.22, 1);
    }

    .cursor-follower {
        width: 30px;
        height: 30px;
        background-color: rgba(255, 255, 255, 0.2);
        transition: transform 0.3s cubic-bezier(0.19, 1, 0.22, 1);
    }

    /* State when hovering over interactive elements */
    .cursor-grow .custom-cursor {
        transform: translate(-50%, -50%) scale(0.5);
        opacity: 0.8;
    }
    .cursor-grow .cursor-follower {
        transform: translate(-50%, -50%) scale(1.5);
        background-color: rgba(59, 130, 246, 0.2);
    }
    /* Spotlight effect that follows the cursor */
    .spotlight {
        position: fixed;
        top: 0;
        left: 0;
        width: 400px;
        height: 400px;
        border-radius: 50%;
        background: radial-gradient(circle, rgba(59, 130, 246, 0.15) 0%, rgba(59, 130, 246, 0) 70%);
        pointer-events: none;
        transform: translate(-50%, -50%);
        z-index: 100;
    }
  </style>
</head>
<body>
  <!-- Custom cursor elements -->
  <div id="custom-cursor" class="custom-cursor"></div>
  <div id="cursor-follower" class="cursor-follower"></div>
  <!-- Spotlight effect element -->
  <div id="spotlight" class="spotlight"></div>
  <a href="index.html" class="back-button" title="Басты бетке оралу">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>
  </a>
  <style>
    .modal-overlay { backdrop-filter: blur(8px); }
    .modal-box { background: linear-gradient(180deg, #0b1220, #07101a); border: 1px solid rgba(255,255,255,0.06); padding: 1.5rem; border-radius: 12px; width: 100%; max-width: 480px; box-shadow: 0 30px 80px rgba(0,0,0,0.8); position: relative; } .modal-close { position: absolute; right: 12px; top: 10px; background: transparent; border: none; color: rgba(255,255,255,0.8); font-size: 1.4rem; cursor: pointer; } .modal-input { width: 100%; padding: 0.6rem 0.75rem; background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.06); color: #fff; border-radius: 8px; } .modal-input:focus { outline: none; border-color: rgba(59,130,246,0.6); box-shadow: 0 6px 20px rgba(59,130,246,0.06); } .modal-box label { color: rgba(255,255,255,0.85); } .modal-box .text-sm { font-size: 0.9rem; }
  </style>
  <!-- Registration Modal (hidden by default) -->
  <div id="registration-modal" class="modal-overlay" aria-hidden="true" style="display:none;">
      <div class="modal-box" role="dialog" aria-modal="true" aria-labelledby="reg-title">
          <button id="reg-close" class="modal-close" aria-label="Close">×</button>
          <h3 id="reg-title" class="text-2xl font-semibold mb-4">Тіркелу</h3>
          <form id="reg-form">
              <label class="block mb-2 text-sm">Аты-жөні</label>
              <input id="reg-name" type="text" class="modal-input mb-3" required />

              <label class="block mb-2 text-sm">Электрондық пошта</label>
              <input id="reg-email" type="email" class="modal-input mb-3" required />

              <label class="block mb-2 text-sm">Құпия сөз</label>
              <input id="reg-password" type="password" class="modal-input mb-3" required minlength="6" />

              <div id="reg-error" class="text-sm text-red-400 mb-3" style="display:none;"></div>

              <div class="flex items-center gap-3"><button type="submit" id="reg-submit" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-full">Тіркелу</button><button type="button" id="reg-cancel" class="bg-white/10 hover:bg-white/20 text-white px-4 py-2 rounded-full">Болдырмау</button></div>
              <div id="reg-success" class="text-sm text-green-400 mt-4" style="display:none;">Тіркелу сәтті аяқталды!</div>
          </form>
      </div>
  </div>
  <header>
    <div class="logo">
      <div class="badge">G</div>
      <div>
        <h1>Apple бөлімі</h1>
        <div class="subtitle"> </div>
      </div>
    </div>

    <div class="meta">
      <div class="search" role="search">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" aria-hidden><path d="M21 21l-4.35-4.35" stroke="#cfe3ff" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
        <input id="q" placeholder="Поиск iPhone..." />
      </div>
      <div style="width:8px"></div>
      <button class="chip" onclick="toggleSort()">Әдепкі сұрыптау </button>
      <button id="register-btn" class="nav-button transition" aria-haspopup="dialog" aria-controls="registration-modal" style="margin-left: 12px;">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
          </svg>
      </button>
      <a href="cart.html" class="hover:text-white/70 transition relative" title="Себет" style="margin-left: 12px;">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" style="width: 24px; height: 24px;"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"></path></svg>
          <span class="cart-counter">0</span>
      </a>
    </div>
  </header>

  <main>
    <section class="hero">
      <div class="title">
        <h2>Жаңа және танымал iPhone</h2>
        <p>iPhone каталогы — нақты шамамен бағалар (жинақталған күн — 2025 жылғы 13 қараша). «Қосу» батырмасын басып, себетке қосу әсерін имитациялауға болады.</p>
      </div>
    </section>

    <div class="filters" id="filters">
      <div class="chip active" data-filter="all" onclick="filterBy('all', this)">Барлығы</div>
      <div class="chip" data-filter="phones" onclick="filterBy('phones', this)">iPhone</div>
      <div class="chip" data-filter="headphones" onclick="filterBy('headphones', this)">AirPods</div>
      <div class="chip" data-filter="laptops" onclick="filterBy('laptops', this)">MacBook</div>
      <div class="chip" data-filter="computers" onclick="filterBy('computers', this)">iMac</div>
      <div class="chip" data-filter="watches" onclick="filterBy('watches', this)">Apple Watch</div>
      <div style="flex:1"></div>
      <div class="note">Бағалар шамамен — дереккөздер: Apple / Amazon / жаңалықтар.</div>
    </div>

    <div class="grid" id="grid"></div>

  </main>

  <footer>
   Бағалар мен қолжетімділік үнемі жаңартылып отырады.
  </footer>

  <script src="iphone.js"></script>
  <script src="cart.js"></script>
  <script>
    // Custom cursor logic
    function setupCustomCursor() {
        const cursor = document.getElementById('custom-cursor');
        const follower = document.getElementById('cursor-follower');
        if (!cursor || !follower) return;

        let mouseX = 0, mouseY = 0;
        let followerX = 0, followerY = 0;
        const speed = 0.1; // How fast the follower catches up

        document.addEventListener('mousemove', (e) => {
            mouseX = e.clientX;
            mouseY = e.clientY;
            cursor.style.transform = `translate(${mouseX}px, ${mouseY}px)`;
        });

        function animateFollower() {
            followerX += (mouseX - followerX) * speed;
            followerY += (mouseY - followerY) * speed;
            follower.style.transform = `translate(${followerX}px, ${followerY}px)`;
            requestAnimationFrame(animateFollower);
        }
        animateFollower();

        // Add hover effect on interactive elements
        const interactiveElements = document.querySelectorAll('a, button, input, [role="button"], .chip');
        interactiveElements.forEach(el => {
            el.addEventListener('mouseenter', () => document.body.classList.add('cursor-grow'));
            el.addEventListener('mouseleave', () => document.body.classList.remove('cursor-grow'));
        });
    }

    // Spotlight effect that follows the mouse
    function setupSpotlightEffect() {
        const spotlight = document.getElementById('spotlight');
        if (!spotlight) return;

        document.addEventListener('mousemove', (e) => {
            // Use requestAnimationFrame for performance
            requestAnimationFrame(() => {
                spotlight.style.left = `${e.clientX}px`;
                spotlight.style.top = `${e.clientY}px`;
            });
        });
    }

    function setupRegistrationModal() {
        const openBtn = document.getElementById('register-btn');
        const modal = document.getElementById('registration-modal');
        const closeBtn = document.getElementById('reg-close');
        const cancelBtn = document.getElementById('reg-cancel');
        const form = document.getElementById('reg-form');
        const inputName = document.getElementById('reg-name');
        const inputEmail = document.getElementById('reg-email');
        const inputPassword = document.getElementById('reg-password');
        const errorEl = document.getElementById('reg-error');
        const successEl = document.getElementById('reg-success');

        if (!openBtn || !modal || !form) return;

        function openModal() {
            modal.style.display = 'flex';
            modal.setAttribute('aria-hidden', 'false');
            setTimeout(() => inputName && inputName.focus(), 80);
        }

        function closeModal() {
            modal.style.display = 'none';
            modal.setAttribute('aria-hidden', 'true');
            form.reset();
            if (errorEl) { errorEl.style.display = 'none'; errorEl.textContent = ''; }
            if (successEl) { successEl.style.display = 'none'; }
        }

        openBtn.addEventListener('click', (e) => { e.preventDefault(); openModal(); });
        if (closeBtn) closeBtn.addEventListener('click', closeModal);
        if (cancelBtn) cancelBtn.addEventListener('click', closeModal);
        modal.addEventListener('click', (e) => { if (e.target === modal) closeModal(); });
        document.addEventListener('keydown', (e) => { if (e.key === 'Escape' && modal.style.display === 'flex') closeModal(); });

        function validateEmail(email) { return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email); }

        form.addEventListener('submit', (e) => {
            e.preventDefault();
            if (!inputName || !inputEmail || !inputPassword) return;
            const name = inputName.value.trim();
            const email = inputEmail.value.trim();
            const pass = inputPassword.value;

            if (!name) { errorEl.style.display = 'block'; errorEl.textContent = 'Аты-жөніңізді енгізіңіз'; return; }
            if (!validateEmail(email)) { errorEl.style.display = 'block'; errorEl.textContent = 'Жарамды электрондық пошта енгізіңіз'; return; }
            if (!pass || pass.length < 6) { errorEl.style.display = 'block'; errorEl.textContent = 'Құпия сөз кемінде 6 таңбадан тұруы керек'; return; }

            try {
                const list = JSON.parse(localStorage.getItem('registrations') || '[]');
                list.push({ name, email, created: Date.now() });
                localStorage.setItem('registrations', JSON.stringify(list));
            } catch (err) { console.warn('LocalStorage save failed', err); }

            if (errorEl) { errorEl.style.display = 'none'; }
            if (successEl) { successEl.style.display = 'block'; }
            openBtn.innerHTML = 'Тіркелді';
            openBtn.disabled = true;
            setTimeout(() => closeModal(), 1200);
        });
    }

    document.addEventListener('DOMContentLoaded', () => {
        setupCustomCursor();
        setupRegistrationModal();
        setupSpotlightEffect();
    });

    // Add to cart functionality
    document.getElementById('grid').addEventListener('click', function(e) {
        if (e.target && e.target.classList.contains('btn')) {
            const card = e.target.closest('.card');
            const productName = card.querySelector('h3').textContent;
            const product = products.find(p => p.name === productName);
            if (product) addToCart(product);
        }
    });
  </script>
</body>
</html>
